# Archivey

Archivey is a library for reading the contents of many common archive formats. It provides a simple, unified interface on top of several builtin modules and external packages, and improves on some of their shortcomings.


## Features

- Support for ZIP, TAR (including compressed tar variants), RAR, 7z and ISO files, and single-file compressed formats
- Optimized streaming access reading of archive members
- Consistent handling of symlinks, file times, permissions, and passwords
- Consistent exception hierarchy
- Automatic file format detection

## Installation

Recommended:
```
pip install archivey[optional]
```
Or, if you don't want to add all dependencies to your project, add only the ones you need.

RAR support relies on the `unrar` tool, which you'll need to install separately.

| Feature/Format | Python package | System requirement |
| --- | --- | --- |
| RAR archives | `rarfile` | `unrar` binary |
| 7z archives | `py7zr` | |
| ISO images | `pycdlib` | |
| Gzip (fast) | `rapidgzip` | |
| Bzip2 (indexed) | `indexed_bzip2` | |
| XZ (pure Python) | `python-xz` | |
| Zstandard | `zstandard` or `pyzstd` | |
| LZ4 | `lz4` | |

## Usage

### Streaming access
```python
from archivey import open_archive

with open_archive("example.zip") as archive:
    for member, stream in archive.iter_members_with_io():
        print(member.filename, member.file_size)
        if stream:
            data = stream.read()
```

### Random access
```python
from archivey import open_archive

with open_archive("example.zip") as archive:
    members = archive.get_members()
    # Read the contents of the last file in the archive
    member_to_read = members[-1]
    if member_to_read.is_file:
        stream = archive.open(member_to_read)
        data = stream.read()
```

### Configuration
You can enable optional features by passing an `ArchiveyConfig` to `open_archive`.

```python
from archivey import open_archive, ArchiveyConfig

config = ArchiveyConfig(use_rar_stream=True, use_rapidgzip=True)
with open_archive("file.rar", config=config) as archive:
    ...
```

See the [ArchiveyConfig fields](docs/user_guide.md#archiveyconfig-fields) section of the user guide for all options.

## Command line usage

Archivey installs a small command line tool simply called `archivey`.
You can also invoke it via `python -m archivey`.
The CLI is primarily meant for testing or exploring the library rather than
being a full-fledged archive management utility.

```bash
archivey my_archive.zip
archivey --extract --dest out_dir my_archive.zip
```

You can filter member names using shell patterns placed after `--`:

```bash
archivey --list my_archive.zip -- "*.txt"
```

---

## Documentation

For more detailed information on using and extending `archivey`, please refer to the following resources:

*   **[User Guide](docs/user_guide.md)**: Learn how to use `archivey` to open and interact with archives.
*   **[Developer Guide](docs/developer_guide.md)**: Information on adding support for new archive formats by creating custom `ArchiveReader` implementations.
*   **[API Reference](docs/api/archivey/index.html)**: Detailed documentation of all public classes, methods, and functions (generated by pdoc).

